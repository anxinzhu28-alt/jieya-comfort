<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æƒ…ç»ªå®‰æŠšå¼•å¯¼</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #ffd9e8 0%, #f9f0ff 25%, #e0f5ff 50%, #d9ffe8 75%, #fff9d9 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 20px;
            position: relative;
            overflow: hidden;
        }
        
        /* å¡é€šè£…é¥°å…ƒç´  */
        body::before,
        body::after {
            content: '';
            position: absolute;
            background-size: contain;
            background-repeat: no-repeat;
            opacity: 0.3;
            z-index: -1;
        }
        
        body::before {
            top: -50px;
            left: -50px;
            width: 300px;
            height: 300px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="40" fill="%23FFB6C1"/><circle cx="35" cy="40" r="5" fill="white"/><circle cx="65" cy="40" r="5" fill="white"/><path d="M30 60 Q50 80 70 60" stroke="white" stroke-width="3" fill="none"/></svg>');
        }
        
        body::after {
            bottom: -50px;
            right: -50px;
            width: 300px;
            height: 300px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="40" fill="%2387CEFA"/><circle cx="35" cy="40" r="5" fill="white"/><circle cx="65" cy="40" r="5" fill="white"/><path d="M30 60 Q50 80 70 60" stroke="white" stroke-width="3" fill="none"/></svg>');
        }
        
        /* è£…é¥°äº‘æœµ - æ¯›ç»’æè´¨å¯åŠ¨ */
        .cloud {
            position: absolute;
            background: white;
            border-radius: 100px;
            z-index: -1;
            opacity: 0.8;
            box-shadow: 
                0 0 10px rgba(255, 255, 255, 0.8),
                0 0 20px rgba(255, 255, 255, 0.6),
                inset 0 0 15px rgba(255, 255, 255, 0.5),
                inset 0 -5px 10px rgba(240, 240, 240, 0.8);
            animation: float linear infinite;
        }
        
        /* äº‘æœµå½¢çŠ¶ç»†åŒ– */
        .cloud::before,
        .cloud::after {
            content: '';
            position: absolute;
            background: white;
            border-radius: 50%;
            box-shadow: 
                0 0 10px rgba(255, 255, 255, 0.8),
                inset 0 0 10px rgba(255, 255, 255, 0.5);
        }
        
        /* äº‘æœµ1 */
        .cloud1 {
            top: 10%;
            left: 10%;
            width: 100px;
            height: 60px;
            animation-duration: 60s;
        }
        
        .cloud1::before {
            top: -20px;
            left: 10px;
            width: 50px;
            height: 50px;
        }
        
        .cloud1::after {
            top: -15px;
            right: 15px;
            width: 60px;
            height: 60px;
        }
        
        /* äº‘æœµ2 */
        .cloud2 {
            top: 20%;
            right: 15%;
            width: 120px;
            height: 70px;
            animation-duration: 80s;
            animation-direction: reverse;
        }
        
        .cloud2::before {
            top: -25px;
            left: 15px;
            width: 60px;
            height: 60px;
        }
        
        .cloud2::after {
            top: -20px;
            right: 20px;
            width: 70px;
            height: 70px;
        }
        
        /* äº‘æœµ3 */
        .cloud3 {
            bottom: 15%;
            left: 20%;
            width: 80px;
            height: 50px;
            animation-duration: 70s;
        }
        
        .cloud3::before {
            top: -15px;
            left: 10px;
            width: 40px;
            height: 40px;
        }
        
        .cloud3::after {
            top: -10px;
            right: 10px;
            width: 50px;
            height: 50px;
        }
        
        /* äº‘æœµæµ®åŠ¨åŠ¨ç”» */
        @keyframes float {
            0% {
                transform: translateX(0) translateY(0);
            }
            25% {
                transform: translateX(20px) translateY(-10px);
            }
            50% {
                transform: translateX(0) translateY(0);
            }
            75% {
                transform: translateX(-20px) translateY(10px);
            }
            100% {
                transform: translateX(0) translateY(0);
            }
        }
        
        /* å¯çˆ±çš„è£…é¥°å…ƒç´  */
        
        /* å½©è™¹ */
        .rainbow {
            position: absolute;
            width: 300px;
            height: 150px;
            border-radius: 150px 150px 0 0;
            background: linear-gradient(
                to bottom,
                #FF0000 0%,
                #FF7F00 14.28%,
                #FFFF00 28.56%,
                #00FF00 42.84%,
                #0000FF 57.12%,
                #4B0082 71.4%,
                #9400D3 85.68%,
                rgba(148, 0, 211, 0) 100%
            );
            opacity: 0.6;
            z-index: -1;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            box-shadow: 0 0 30px rgba(255, 100, 100, 0.3);
            animation: rainbowFloat 8s ease-in-out infinite;
        }
        
        @keyframes rainbowFloat {
            0%, 100% {
                transform: translateX(-50%) translateY(0);
                opacity: 0.6;
            }
            50% {
                transform: translateX(-50%) translateY(-10px);
                opacity: 0.8;
            }
        }
        
        /* æ˜Ÿæ˜Ÿ */
        .star {
            position: absolute;
            background: white;
            clip-path: polygon(
                50% 0%,
                61% 35%,
                98% 35%,
                68% 57%,
                79% 91%,
                50% 70%,
                21% 91%,
                32% 57%,
                2% 35%,
                39% 35%
            );
            animation: twinkle ease-in-out infinite;
            z-index: -1;
        }
        
        .star1 {
            top: 15%;
            right: 10%;
            width: 20px;
            height: 20px;
            animation-duration: 3s;
        }
        
        .star2 {
            top: 30%;
            left: 5%;
            width: 15px;
            height: 15px;
            animation-duration: 4s;
        }
        
        .star3 {
            bottom: 25%;
            right: 15%;
            width: 18px;
            height: 18px;
            animation-duration: 5s;
        }
        
        @keyframes twinkle {
            0%, 100% {
                opacity: 0.3;
                transform: scale(0.8);
            }
            50% {
                opacity: 1;
                transform: scale(1);
            }
        }
        
        /* å¯çˆ±çš„å°åŠ¨ç‰© - å¤ªé˜³ */
        .sun {
            position: absolute;
            top: 5%;
            left: 5%;
            width: 70px;
            height: 70px;
            background: #FFD700;
            border-radius: 50%;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.8);
            z-index: -1;
            animation: spin 20s linear infinite;
        }
        
        .sun::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 50px;
            height: 50px;
            background: #FFA500;
            border-radius: 50%;
        }
        
        /* å¤ªé˜³çš„ç¬‘è„¸ */
        .sun::after {
            content: 'ğŸ˜Š';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 25px;
            z-index: 1;
        }
        
        @keyframes spin {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(360deg);
            }
        }
        
        /* å¯çˆ±çš„æŒ‰é’®æ•ˆæœ */
        .start-button, .submit-button {
            position: relative;
            overflow: hidden;
        }
        
        .start-button::before, .submit-button::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(
                to bottom right,
                transparent,
                rgba(255, 255, 255, 0.3),
                transparent
            );
            transform: rotate(45deg);
            animation: shine 3s ease-in-out infinite;
        }
        
        @keyframes shine {
            0% {
                transform: translateX(-100%) rotate(45deg);
            }
            100% {
                transform: translateX(100%) rotate(45deg);
            }
        }
        
        /* å‘¼å¸åœ†åœˆçš„å¯çˆ±æ•ˆæœ */
        .breathing-circle {
            position: relative;
        }
        
        .breathing-circle::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            animation: pulse 4s ease-in-out infinite;
        }
        
        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
                opacity: 0.3;
            }
            50% {
                transform: scale(1.1);
                opacity: 0.1;
            }
        }
        
        .container {
            max-width: 600px;
            width: 100%;
            background-color: white;
            border-radius: 20px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
            overflow: hidden;
            position: relative;
        }
        
        .container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 8px;
            background: linear-gradient(90deg, #FF6B6B, #4ECDC4, #45B7D1, #FFA07A);
        }
        
        .start-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 60px 20px;
            text-align: center;
        }
        
        .start-button {
            background: linear-gradient(135deg, #FF6B6B, #FF8E53);
            color: white;
            border: none;
            padding: 20px 40px;
            font-size: 20px;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 6px 16px rgba(255, 107, 107, 0.4);
            font-weight: bold;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .start-button:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 20px rgba(255, 107, 107, 0.6);
        }
        
        .guide-section {
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 60px 20px;
            text-align: center;
            position: relative;
        }
        
        .breathing-circle {
            width: 220px;
            height: 220px;
            border-radius: 50%;
            background: linear-gradient(135deg, #4ECDC4, #45B7D1);
            margin: 30px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 26px;
            transition: all 4s ease;
            box-shadow: 0 8px 24px rgba(78, 205, 196, 0.3);
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .breathing-circle.expanding {
            transform: scale(1.2);
            background: linear-gradient(135deg, #45B7D1, #3A8DBD);
        }
        
        .breathing-circle.contracting {
            transform: scale(0.8);
            background: linear-gradient(135deg, #3A8DBD, #2C7AB3);
        }
        
        .instruction-text {
            font-size: 26px;
            margin: 20px 0;
            color: #333;
            font-weight: bold;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }
        
        .comforting-text {
            font-size: 22px;
            color: #666;
            line-height: 1.6;
            max-width: 400px;
            font-weight: 500;
        }
        
        .timer {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 18px;
            color: #666;
            background-color: rgba(255, 255, 255, 0.8);
            padding: 8px 16px;
            border-radius: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .back-button {
            position: absolute;
            top: 20px;
            left: 20px;
            background: linear-gradient(135deg, #95A5A6, #BDC3C7);
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            color: white;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(149, 165, 166, 0.3);
            font-weight: bold;
        }
        
        .back-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(149, 165, 166, 0.4);
        }
        
        .submit-button {
            background: linear-gradient(135deg, #9B59B6, #8E44AD) !important;
            color: white !important;
            border: none !important;
            padding: 12px 24px !important;
            font-size: 16px !important;
            border-radius: 25px !important;
            cursor: pointer !important;
            transition: all 0.3s ease !important;
            box-shadow: 0 4px 12px rgba(155, 89, 182, 0.3) !important;
            font-weight: bold !important;
        }
        
        .submit-button:hover {
            transform: translateY(-2px) !important;
            box-shadow: 0 6px 16px rgba(155, 89, 182, 0.4) !important;
        }
        
        h3 {
            color: #333 !important;
            font-size: 22px !important;
            font-weight: bold !important;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1) !important;
        }
        
        /* çƒ¦æ¼è¾“å…¥æ¡†æ ·å¼ */
        #worryInput {
            transition: all 0.3s ease !important;
        }
        
        #worryInput:focus {
            outline: none !important;
            box-shadow: 
                0 0 20px rgba(78, 205, 196, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.8) !important;
        }
        
        @keyframes borderAnimation {
            0% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
            100% {
                background-position: 0% 50%;
            }
        }
        
        /* è°ƒæ•´è¾“å…¥æ¡†å ä½ç¬¦æ ·å¼ */
        textarea::placeholder {
            color: #999 !important;
            font-style: italic !important;
            transition: all 0.3s ease !important;
        }
        
        textarea:focus::placeholder {
            color: #ccc !important;
        }
        
        /* çƒ¦æ¼è¾“å…¥åŒºåŸŸçš„æ ‡é¢˜æ ·å¼ */
        .çƒ¦æ¼è¾“å…¥ h3 {
            position: relative !important;
            display: inline-block !important;
        }
        
        .çƒ¦æ¼è¾“å…¥ h3::after {
            content: '' !important;
            position: absolute !important;
            bottom: -5px !important;
            left: 0 !important;
            width: 100% !important;
            height: 3px !important;
            background: linear-gradient(90deg, #FF6B6B, #4ECDC4, #9B59B6) !important;
            border-radius: 3px !important;
            animation: titleShine 3s ease-in-out infinite !important;
        }
        
        @keyframes titleShine {
            0%, 100% {
                transform: scaleX(1);
                opacity: 0.7;
            }
            50% {
                transform: scaleX(1.05);
                opacity: 1;
            }
        }
    </style>
</head>
<body>
    <!-- å¡é€šè£…é¥°å…ƒç´  -->
    <!-- äº‘æœµ -->
    <div class="cloud cloud1"></div>
    <div class="cloud cloud2"></div>
    <div class="cloud cloud3"></div>
    
    <!-- å½©è™¹ -->
    <div class="rainbow"></div>
    
    <!-- æ˜Ÿæ˜Ÿ -->
    <div class="star star1"></div>
    <div class="star star2"></div>
    <div class="star star3"></div>
    
    <!-- å¤ªé˜³ -->
    <div class="sun"></div>
    
    <div class="container">
        <!-- å¼€å§‹é¡µé¢ -->
        <div class="start-section" id="startSection">
            <button class="start-button" id="startButton">æˆ‘ç°åœ¨æœ‰ç‚¹æ’‘ä¸ä½</button>
            
            <div class="çƒ¦æ¼è¾“å…¥" style="margin-top: 40px; width: 80%; max-width: 400px;">
                <h3 style="margin-bottom: 10px; color: #333;">åˆ†äº«ä½ çš„çƒ¦æ¼</h3>
                <div style="position: relative; border-radius: 16px; padding: 3px; background: linear-gradient(45deg, #FFD9E8, #F9F0FF, #E0F5FF, #D9FFE8); background-size: 400% 400%; animation: borderAnimation 8s linear infinite;">
                    <textarea id="worryInput" placeholder="è¯·è¾“å…¥ä½ çš„çƒ¦æ¼..." style="width: 100%; padding: 15px; border: none; border-radius: 13px; font-size: 16px; resize: vertical; min-height: 120px; font-family: Arial, sans-serif; background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.8);"></textarea>
                </div>
                <button class="submit-button" id="submitWorry" style="margin-top: 15px; background-color: #4CAF50; color: white; border: none; padding: 12px 24px; font-size: 16px; border-radius: 25px; cursor: pointer; transition: all 0.3s ease;">è·å–å®‰æ…°</button>
            </div>
            
            <!-- AIå›å¤åŒºåŸŸ -->
            <div class="ai-response" id="aiResponse" style="margin-top: 30px; width: 80%; max-width: 400px; display: none;">
                <h3 style="margin-bottom: 10px; color: #333;">AIçš„å®‰æ…°</h3>
                <div id="responseText" style="padding: 15px; border: 1px solid #ddd; border-radius: 8px; background-color: #f9f9f9; font-size: 16px; line-height: 1.5;"></div>
            </div>
        </div>
        
        <!-- å¼•å¯¼é¡µé¢ -->
        <div class="guide-section" id="guideSection">
            <button class="back-button" id="backButton">è¿”å›</button>
            <div class="timer" id="timer">00:00</div>
            
            <!-- å‘¼å¸å¼•å¯¼ -->
            <div id="breathingGuide" class="breathing-guide">
                <div class="instruction-text" id="breathingText">å‡†å¤‡å¼€å§‹å‘¼å¸ç»ƒä¹ </div>
                <div class="breathing-circle" id="breathingCircle"></div>
            </div>
            
            <!-- åŠ¨ä½œæŒ‡ä»¤ -->
            <div id="actionGuide" class="action-guide" style="display: none;">
                <div class="instruction-text" id="actionText">å‡†å¤‡å¼€å§‹åŠ¨ä½œç»ƒä¹ </div>
            </div>
            
            <!-- å®‰æŠšè¯è¯­ -->
            <div id="comfortGuide" class="comfort-guide" style="display: none;">
                <div class="comforting-text" id="comfortText">å‡†å¤‡å¼€å§‹å®‰æŠš</div>
            </div>
        </div>
    </div>
    
    <script>
        // DOMå…ƒç´ 
        const startSection = document.getElementById('startSection');
        const guideSection = document.getElementById('guideSection');
        const startButton = document.getElementById('startButton');
        const backButton = document.getElementById('backButton');
        const timer = document.getElementById('timer');
        
        // å‘¼å¸å¼•å¯¼å…ƒç´ 
        const breathingGuide = document.getElementById('breathingGuide');
        const breathingText = document.getElementById('breathingText');
        const breathingCircle = document.getElementById('breathingCircle');
        
        // åŠ¨ä½œæŒ‡ä»¤å…ƒç´ 
        const actionGuide = document.getElementById('actionGuide');
        const actionText = document.getElementById('actionText');
        
        // å®‰æŠšè¯è¯­å…ƒç´ 
        const comfortGuide = document.getElementById('comfortGuide');
        const comfortText = document.getElementById('comfortText');
        
        // æ€»æ—¶é•¿ (30ç§’å‘¼å¸ + 20ç§’åŠ¨ä½œ + 10ç§’å®‰æŠš)
        const TOTAL_DURATION = 60;
        let elapsedTime = 0;
        let timerInterval = null;
        
        // å¼€å§‹æŒ‰é’®ç‚¹å‡»äº‹ä»¶
        startButton.addEventListener('click', startGuide);
        
        // è¿”å›æŒ‰é’®ç‚¹å‡»äº‹ä»¶
        backButton.addEventListener('click', goBack);
        
        // å¼€å§‹å¼•å¯¼æµç¨‹
        function startGuide() {
            startSection.style.display = 'none';
            guideSection.style.display = 'flex';
            
            // é‡ç½®è®¡æ—¶å™¨
            elapsedTime = 0;
            updateTimer();
            
            // å¼€å§‹è®¡æ—¶
            timerInterval = setInterval(() => {
                elapsedTime++;
                updateTimer();
                
                // æ£€æŸ¥æ˜¯å¦å®Œæˆæ‰€æœ‰æ­¥éª¤
                if (elapsedTime >= TOTAL_DURATION) {
                    clearInterval(timerInterval);
                    goBack();
                }
            }, 1000);
            
            // å¼€å§‹å‘¼å¸å¼•å¯¼
            startBreathingGuide();
        }
        
        // æ›´æ–°è®¡æ—¶å™¨æ˜¾ç¤º
        function updateTimer() {
            const minutes = Math.floor(elapsedTime / 60);
            const seconds = elapsedTime % 60;
            timer.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }
        
        // å¼€å§‹å‘¼å¸å¼•å¯¼ (25ç§’)
        function startBreathingGuide() {
            breathingGuide.style.display = 'flex';
            actionGuide.style.display = 'none';
            comfortGuide.style.display = 'none';
            
            let breathCount = 0;
            const maxBreaths = 4; // æ€»å…±25ç§’
            
            function breatheIn() {
                breathingText.textContent = 'å¸æ°”...';
                breathingCircle.className = 'breathing-circle expanding';
                
                setTimeout(() => {
                    breatheOut();
                }, 3000); // å¸æ°”3ç§’
            }
            
            function breatheOut() {
                breathingText.textContent = 'å‘¼æ°”...';
                breathingCircle.className = 'breathing-circle contracting';
                
                breathCount++;
                
                if (breathCount < maxBreaths) {
                    setTimeout(() => {
                        breatheIn();
                    }, 3000); // å‘¼æ°”3ç§’
                } else {
                    // å‘¼å¸å¼•å¯¼ç»“æŸï¼Œå¼€å§‹åŠ¨ä½œæŒ‡ä»¤
                    setTimeout(startActionGuide, 1000);
                }
            }
            
            // å¼€å§‹å‘¼å¸å¾ªç¯
            breatheIn();
        }
        
        // å¼€å§‹åŠ¨ä½œæŒ‡ä»¤ (20ç§’)
        function startActionGuide() {
            breathingGuide.style.display = 'none';
            actionGuide.style.display = 'flex';
            comfortGuide.style.display = 'none';
            
            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            actionText.textContent = 'Deepseek AIæ­£åœ¨ç”ŸæˆåŠ¨ä½œå»ºè®®...';
            
            // è°ƒç”¨Deepseek APIç”ŸæˆåŠ¨ä½œå»ºè®®
            generateActionsWithDeepseek()
                .then(actions => {
                    let actionIndex = 0;
                    
                    function showNextAction() {
                        if (actionIndex < actions.length) {
                            actionText.textContent = actions[actionIndex];
                            actionIndex++;
                            
                            setTimeout(showNextAction, 6000); // æ¯ä¸ªåŠ¨ä½œ6ç§’ï¼Œ3ä¸ªåŠ¨ä½œå…±18ç§’
                        } else {
                            // åŠ¨ä½œæŒ‡ä»¤ç»“æŸï¼Œå¼€å§‹å®‰æŠšè¯è¯­
                            setTimeout(startComfortGuide, 2000);
                        }
                    }
                    
                    // å¼€å§‹åŠ¨ä½œå¾ªç¯
                    showNextAction();
                })
                .catch(error => {
                    console.error('Deepseek APIè°ƒç”¨å¤±è´¥:', error);
                    // å¤±è´¥æ—¶ä½¿ç”¨å¤‡ç”¨åŠ¨ä½œåº“
                    useFallbackActions();
                });
        }
        
        // ä½¿ç”¨Deepseek APIç”ŸæˆåŠ¨ä½œå»ºè®®
        async function generateActionsWithDeepseek() {
            try {
                // æ³¨æ„ï¼šè¿™é‡Œéœ€è¦æ›¿æ¢ä¸ºå®é™…çš„Deepseek APIå¯†é’¥å’Œç«¯ç‚¹
                const apiKey = 'YOUR_DEEPSEEK_API_KEY';
                const apiUrl = 'https://api.deepseek.com/v1/chat/completions';
                
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${apiKey}`
                    },
                    body: JSON.stringify({
                        model: 'deepseek-chat',
                        messages: [
                            {
                                role: 'system',
                                content: 'ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æ”¾æ¾æŒ‡å¯¼åŠ©æ‰‹ï¼Œè¯·ç”Ÿæˆ3ä¸ªç®€çŸ­çš„æ”¾æ¾åŠ¨ä½œæŒ‡ä»¤ï¼Œæ¯ä¸ªåŠ¨ä½œä¸è¶…è¿‡20å­—ï¼Œä¸åŒ…å«é—­ä¸Šçœ¼ç›çš„åŠ¨ä½œï¼ŒåŠ¨ä½œè¦ç®€å•æ˜“åšï¼Œé€‚åˆåœ¨ä»»ä½•åœºåˆè¿›è¡Œã€‚'
                            },
                            {
                                role: 'user',
                                content: 'è¯·ç”Ÿæˆ3ä¸ªç®€çŸ­çš„æ”¾æ¾åŠ¨ä½œæŒ‡ä»¤'
                            }
                        ],
                        max_tokens: 200,
                        temperature: 0.7
                    })
                });
                
                if (!response.ok) {
                    throw new Error(`APIè°ƒç”¨å¤±è´¥: ${response.status}`);
                }
                
                const data = await response.json();
                const content = data.choices[0].message.content;
                
                // è§£æç”Ÿæˆçš„åŠ¨ä½œ
                const actions = content.split('\n')
                    .filter(line => line.trim() !== '')
                    .map(line => line.replace(/^\d+\.\s*/, '').trim())
                    .slice(0, 3);
                
                return actions;
            } catch (error) {
                console.error('Deepseek APIè°ƒç”¨å¤±è´¥:', error);
                // å¤±è´¥æ—¶ä½¿ç”¨å¤‡ç”¨åŠ¨ä½œåº“
                return getFallbackActions();
            }
        }
        
        // ä½¿ç”¨å¤‡ç”¨åŠ¨ä½œåº“
        function useFallbackActions() {
            const actions = getFallbackActions();
            let actionIndex = 0;
            
            function showNextAction() {
                if (actionIndex < actions.length) {
                    actionText.textContent = actions[actionIndex];
                    actionIndex++;
                    
                    setTimeout(showNextAction, 6000); // æ¯ä¸ªåŠ¨ä½œ6ç§’ï¼Œ3ä¸ªåŠ¨ä½œå…±18ç§’
                } else {
                    // åŠ¨ä½œæŒ‡ä»¤ç»“æŸï¼Œå¼€å§‹å®‰æŠšè¯è¯­
                    setTimeout(startComfortGuide, 2000);
                }
            }
            
            // å¼€å§‹åŠ¨ä½œå¾ªç¯
            showNextAction();
        }
        
        // è·å–å¤‡ç”¨åŠ¨ä½œ
        function getFallbackActions() {
            // ä¸°å¯Œçš„åŠ¨ä½œåº“ï¼Œä½œä¸ºå¤‡ç”¨
            const actionLibrary = [
                'æ”¾æ¾è‚©è†€ï¼Œä»é¢ˆéƒ¨å¼€å§‹æ…¢æ…¢å‘ä¸‹æ”¾æ¾',
                'ç¼“æ…¢è½¬åŠ¨é¢ˆéƒ¨ï¼Œé¡ºæ—¶é’ˆè½¬ä¸€åœˆï¼Œå†é€†æ—¶é’ˆè½¬ä¸€åœˆ',
                'ä¼¸å±•æ‰‹è‡‚ï¼Œå‘ä¸Šä¼¸ç›´ï¼Œæ„Ÿå—è‚Œè‚‰çš„æ‹‰ä¼¸',
                'æ”¾æ¾å…¨èº«è‚Œè‚‰ï¼Œä»å¤´éƒ¨å¼€å§‹é€æ¸æ”¾æ¾åˆ°è„šè¶¾',
                'è½»è½»æŒ‰æ‘©å¤ªé˜³ç©´ï¼Œç¼“è§£å¤´éƒ¨ç´§å¼ ',
                'ç¼“æ…¢çœ¨çœ¼ï¼Œæ”¾æ¾çœ¼éƒ¨è‚Œè‚‰',
                'æ”¶ç´§å†æ”¾æ¾æ‹³å¤´ï¼Œé‡å¤å‡ æ¬¡',
                'ç¼“æ…¢ç‚¹å¤´ï¼Œæ”¾æ¾é¢ˆéƒ¨è‚Œè‚‰',
                'è½»è½»è½¬åŠ¨æ‰‹è…•ï¼Œé¡ºæ—¶é’ˆå’Œé€†æ—¶é’ˆå„è½¬å‡ åœˆ',
                'æ”¾æ¾é¢éƒ¨è‚Œè‚‰ï¼Œè½»è½»å¾®ç¬‘',
                'ç¼“æ…¢æ”¶è…¹å†æ”¾æ¾ï¼Œæ„Ÿå—è…¹éƒ¨çš„èµ·ä¼',
                'è½»è½»æŒ‰æ‘©è‚©éƒ¨ï¼Œç¼“è§£ç´§å¼ æ„Ÿ',
                'ç¼“æ…¢è½¬åŠ¨è„šè¸ï¼Œæ”¾æ¾ä¸‹è‚¢',
                'åŒæ‰‹è½»è½»æ‰æ“ï¼Œäº§ç”Ÿæ¸©æš–æ„Ÿ'
            ];
            
            // éšæœºé€‰æ‹©3ä¸ªä¸åŒçš„åŠ¨ä½œ
            let selectedActions = [];
            while (selectedActions.length < 3) {
                const randomIndex = Math.floor(Math.random() * actionLibrary.length);
                const action = actionLibrary[randomIndex];
                if (!selectedActions.includes(action)) {
                    selectedActions.push(action);
                }
            }
            
            return selectedActions;
        }
        
        // å¼€å§‹å®‰æŠšè¯è¯­ (10ç§’)
        function startComfortGuide() {
            breathingGuide.style.display = 'none';
            actionGuide.style.display = 'none';
            comfortGuide.style.display = 'flex';
            
            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            comfortText.textContent = 'Deepseek AIæ­£åœ¨ç”Ÿæˆå®‰æŠšè¯è¯­...';
            
            // è°ƒç”¨Deepseek APIç”Ÿæˆå®‰æŠšè¯è¯­
            generateComfortMessagesWithDeepseek()
                .then(messages => {
                    // åªæ˜¾ç¤ºç¬¬ä¸€ä¸ªå®‰æŠšè¯è¯­
                    comfortText.textContent = messages[0];
                    
                    // 10ç§’åç»“æŸå®‰æŠšè¯è¯­
                    setTimeout(() => {
                        clearInterval(timerInterval);
                        goBack();
                    }, 10000);
                })
                .catch(error => {
                    console.error('Deepseek APIè°ƒç”¨å¤±è´¥:', error);
                    // å¤±è´¥æ—¶ä½¿ç”¨å¤‡ç”¨å®‰æŠšè¯è¯­åº“
                    useFallbackComfortMessages();
                });
        }
        
        // ä½¿ç”¨Deepseek APIç”Ÿæˆå®‰æŠšè¯è¯­
        async function generateComfortMessagesWithDeepseek() {
            try {
                // æ³¨æ„ï¼šè¿™é‡Œéœ€è¦æ›¿æ¢ä¸ºå®é™…çš„Deepseek APIå¯†é’¥å’Œç«¯ç‚¹
                const apiKey = 'YOUR_DEEPSEEK_API_KEY';
                const apiUrl = 'https://api.deepseek.com/v1/chat/completions';
                
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${apiKey}`
                    },
                    body: JSON.stringify({
                        model: 'deepseek-chat',
                        messages: [
                            {
                                role: 'system',
                                content: 'ä½ æ˜¯ä¸€ä¸ªæ¸©æš–çš„å¿ƒç†æ”¯æŒåŠ©æ‰‹ï¼Œè¯·ç”Ÿæˆ1æ¡ç®€çŸ­çš„å®‰æŠšè¯è¯­ï¼Œä¸è¶…è¿‡30å­—ï¼Œè¯­æ°”æ¸©æŸ”ã€é¼“åŠ±ï¼Œå¸®åŠ©æƒ…ç»ªä½è½çš„äººæ„Ÿåˆ°è¢«ç†è§£å’Œæ”¯æŒã€‚'
                            },
                            {
                                role: 'user',
                                content: 'è¯·ç”Ÿæˆ1æ¡ç®€çŸ­çš„å®‰æŠšè¯è¯­'
                            }
                        ],
                        max_tokens: 100,
                        temperature: 0.7
                    })
                });
                
                if (!response.ok) {
                    throw new Error(`APIè°ƒç”¨å¤±è´¥: ${response.status}`);
                }
                
                const data = await response.json();
                const message = data.choices[0].message.content.trim();
                
                // è¿”å›å•ä¸ªæ¶ˆæ¯
                return [message];
            } catch (error) {
                console.error('Deepseek APIè°ƒç”¨å¤±è´¥:', error);
                // å¤±è´¥æ—¶ä½¿ç”¨å¤‡ç”¨å®‰æŠšè¯è¯­åº“
                return [getFallbackComfortMessages()];
            }
        }
        
        // ä½¿ç”¨å¤‡ç”¨å®‰æŠšè¯è¯­åº“
        function useFallbackComfortMessages() {
            const message = getFallbackComfortMessages();
            comfortText.textContent = message;
            
            // 10ç§’åç»“æŸå®‰æŠšè¯è¯­
            setTimeout(() => {
                clearInterval(timerInterval);
                goBack();
            }, 10000);
        }
        
        // è·å–å¤‡ç”¨å®‰æŠšè¯è¯­
        function getFallbackComfortMessages() {
            // ä¸°å¯Œçš„å®‰æŠšè¯è¯­åº“ï¼Œä½œä¸ºå¤‡ç”¨
            const comfortingMessages = [
                'ä½ åšå¾—å¾ˆå¥½ï¼Œç»™è‡ªå·±ä¸€ç‚¹æ—¶é—´ï¼Œä¸€åˆ‡éƒ½ä¼šè¿‡å»çš„',
                'å›°éš¾åªæ˜¯æš‚æ—¶çš„ï¼Œä½ æœ‰è¶³å¤Ÿçš„åŠ›é‡åº¦è¿‡è¿™ä¸ªéš¾å…³',
                'ä½ å€¼å¾—è¢«å…³çˆ±å’Œç†è§£ï¼Œä¸è¦å¯¹è‡ªå·±å¤ªè‹›åˆ»',
                'æ…¢æ…¢æ¥ï¼Œç»™è‡ªå·±ç©ºé—´å’Œæ—¶é—´ï¼Œ healingéœ€è¦è¿‡ç¨‹',
                'ä½ ä¸æ˜¯ä¸€ä¸ªäººåœ¨é¢å¯¹è¿™äº›ï¼Œæœ‰å¾ˆå¤šäººå…³å¿ƒç€ä½ ',
                'ä½ çš„æ„Ÿå—æ˜¯åˆç†çš„ï¼Œå…è®¸è‡ªå·±æ„Ÿå—è¿™äº›æƒ…ç»ª',
                'ä½ å·²ç»å¾ˆå‹‡æ•¢äº†ï¼ŒåšæŒåˆ°ç°åœ¨å°±æ˜¯ä¸€ç§èƒœåˆ©',
                'æ¯ä¸€ä¸ªå›°éš¾éƒ½æ˜¯æˆé•¿çš„æœºä¼šï¼Œä½ ä¼šå˜å¾—æ›´å¼ºå¤§',
                'ç»™è‡ªå·±ä¸€ä¸ªæ‹¥æŠ±ï¼Œä½ å€¼å¾—è¢«æ¸©æŸ”å¯¹å¾…',
                'ä»Šå¤©çš„ä½ å·²ç»åšå¾—è¶³å¤Ÿå¥½ï¼Œæ˜å¤©ä¼šæ›´å¥½',
                'ä½ çš„å­˜åœ¨æœ¬èº«å°±æ˜¯æœ‰ä»·å€¼çš„ï¼Œä¸è¦å¿˜è®°è¿™ä¸€ç‚¹',
                'å…è®¸è‡ªå·±ä¼‘æ¯ï¼Œæ¢å¤èƒ½é‡æ˜¯å¾ˆé‡è¦çš„',
                'ä½ ä¸éœ€è¦å®Œç¾ï¼Œåªéœ€è¦åšçœŸå®çš„è‡ªå·±',
                'å›°éš¾ä¼šè¿‡å»ï¼Œé˜³å…‰æ€»ä¼šåˆ°æ¥',
                'ä½ æœ‰èƒ½åŠ›é¢å¯¹è¿™ä¸€åˆ‡ï¼Œç›¸ä¿¡è‡ªå·±'
            ];
            
            // éšæœºé€‰æ‹©1æ¡å®‰æŠšè¯è¯­
            const randomIndex = Math.floor(Math.random() * comfortingMessages.length);
            return comfortingMessages[randomIndex];
        }
        
        // è¿”å›å¼€å§‹é¡µé¢
        function goBack() {
            clearInterval(timerInterval);
            guideSection.style.display = 'none';
            startSection.style.display = 'flex';
        }
        
        // çƒ¦æ¼è¾“å…¥å’ŒAIå›å¤åŠŸèƒ½
        const worryInput = document.getElementById('worryInput');
        const submitWorry = document.getElementById('submitWorry');
        const aiResponse = document.getElementById('aiResponse');
        const responseText = document.getElementById('responseText');
        
        // ç‚¹å‡»è·å–å®‰æ…°æŒ‰é’®
        submitWorry.addEventListener('click', generateAIResponse);
        
        // ç›‘å¬è¾“å…¥æ¡†å˜åŒ–ï¼Œå½“ä¸ºç©ºæ—¶æ¸…ç©ºAIå›å¤
        worryInput.addEventListener('input', function() {
            if (this.value.trim() === '') {
                aiResponse.style.display = 'none';
                responseText.textContent = '';
            }
        });
        
        // ç”ŸæˆAIå›å¤
        function generateAIResponse() {
            const worryText = worryInput.value.trim();
            
            if (!worryText) {
                alert('è¯·è¾“å…¥ä½ çš„çƒ¦æ¼');
                return;
            }
            
            // æ¨¡æ‹ŸAIæ€è€ƒè¿‡ç¨‹
            responseText.textContent = 'AIæ­£åœ¨æ€è€ƒ...';
            aiResponse.style.display = 'block';
            
            // å»¶è¿Ÿæ˜¾ç¤ºå›å¤ï¼Œæ¨¡æ‹ŸAIå¤„ç†æ—¶é—´
            setTimeout(() => {
                const response = getAIResponse(worryText);
                responseText.textContent = response;
            }, 1000);
        }
        
        // æ ¹æ®çƒ¦æ¼å†…å®¹ç”Ÿæˆå›å¤
        function getAIResponse(worry) {
            // å…³é”®è¯åˆ†æ
            const worryLower = worry.toLowerCase();
            
            // å›å¤åº“
            const responses = {
                work: [
                    'å·¥ä½œå‹åŠ›æ˜¯å¾ˆå¸¸è§çš„ï¼Œç»™è‡ªå·±è®¾å®šåˆç†çš„ç›®æ ‡ï¼Œä¸€æ­¥ä¸€æ­¥æ¥',
                    'å·¥ä½œåªæ˜¯ç”Ÿæ´»çš„ä¸€éƒ¨åˆ†ï¼Œä¸è¦è®©å®ƒå æ®ä½ å…¨éƒ¨çš„æ³¨æ„åŠ›',
                    'é€‚å½“çš„ä¼‘æ¯å¯ä»¥æé«˜å·¥ä½œæ•ˆç‡ï¼Œç»™è‡ªå·±ä¸€ç‚¹æ”¾æ¾çš„æ—¶é—´',
                    'å¦‚æœå·¥ä½œçœŸçš„è®©ä½ å¾ˆç—›è‹¦ï¼Œä¹Ÿè®¸å¯ä»¥è€ƒè™‘è°ƒæ•´æˆ–å¯»æ‰¾æ–°çš„æœºä¼š',
                    'ä½ å·²ç»å¾ˆåŠªåŠ›äº†ï¼Œä¸è¦å¯¹è‡ªå·±å¤ªè‹›åˆ»ï¼Œå°½åŠ›å°±å¥½'
                ],
                relationship: [
                    'äººé™…å…³ç³»ç¡®å®å¾ˆå¤æ‚ï¼Œç»™è‡ªå·±å’Œå¯¹æ–¹ä¸€äº›æ—¶é—´å’Œç©ºé—´',
                    'æ²Ÿé€šæ˜¯è§£å†³é—®é¢˜çš„å…³é”®ï¼Œè¯•ç€å¦è¯šåœ°è¡¨è¾¾ä½ çš„æ„Ÿå—',
                    'æ¯ä¸ªäººéƒ½æœ‰è‡ªå·±çš„æƒ³æ³•å’Œæ„Ÿå—ï¼Œå­¦ä¼šç†è§£å’Œæ¥çº³å·®å¼‚',
                    'æœ‰æ—¶å€™æ”¾æ‰‹ä¹Ÿæ˜¯ä¸€ç§é€‰æ‹©ï¼Œä¸è¦å‹‰å¼ºè‡ªå·±åœ¨ä¸å¿«ä¹çš„å…³ç³»ä¸­',
                    'ä½ å€¼å¾—è¢«çˆ±å’Œå°Šé‡ï¼Œä¸è¦å¿˜è®°è¿™ä¸€ç‚¹'
                ],
                health: [
                    'å¥åº·æ˜¯æœ€é‡è¦çš„ï¼Œä¸€å®šè¦ç…§é¡¾å¥½è‡ªå·±çš„èº«ä½“',
                    'å¦‚æœèº«ä½“ä¸é€‚ï¼ŒåŠæ—¶å°±åŒ»æ˜¯æœ€æ˜æ™ºçš„é€‰æ‹©',
                    'è‰¯å¥½çš„ä½œæ¯å’Œé¥®é£Ÿä¹ æƒ¯å¯¹å¥åº·éå¸¸é‡è¦',
                    'é€‚å½“çš„è¿åŠ¨å¯ä»¥æ”¹å–„å¿ƒæƒ…å’Œèº«ä½“çŠ¶å†µ',
                    'ç»™è‡ªå·±ä¸€äº›ä¼‘æ¯æ—¶é—´ï¼Œæ¢å¤ä½“åŠ›å’Œç²¾ç¥'
                ],
                stress: [
                    'å‹åŠ›æ˜¯ç”Ÿæ´»çš„ä¸€éƒ¨åˆ†ï¼Œå­¦ä¼šå¦‚ä½•ç®¡ç†å®ƒå¾ˆé‡è¦',
                    'æ·±å‘¼å¸å’Œå†¥æƒ³å¯ä»¥å¸®åŠ©ç¼“è§£å‹åŠ›',
                    'æŠŠå¤§é—®é¢˜åˆ†è§£æˆå°æ­¥éª¤ï¼Œä¸€æ­¥ä¸€æ­¥è§£å†³',
                    'ä¸è¦ç‹¬è‡ªæ‰¿å—å‹åŠ›ï¼Œå’Œæœ‹å‹æˆ–å®¶äººåˆ†äº«ä½ çš„æ„Ÿå—',
                    'è®°ä½ï¼Œè¿™åªæ˜¯æš‚æ—¶çš„ï¼Œä¸€åˆ‡éƒ½ä¼šå¥½èµ·æ¥çš„'
                ],
                anxiety: [
                    'ç„¦è™‘æ˜¯å¾ˆå¸¸è§çš„ï¼Œä¸è¦ä¸ºæ­¤æ„Ÿåˆ°ç¾è€»',
                    'è¯•ç€ä¸“æ³¨äºå½“ä¸‹ï¼Œè€Œä¸æ˜¯æ‹…å¿ƒæœªæ¥',
                    'æ·±å‘¼å¸ç»ƒä¹ å¯ä»¥å¸®åŠ©ç¼“è§£ç„¦è™‘æ„Ÿ',
                    'å¦‚æœç„¦è™‘ä¸¥é‡å½±å“ä½ çš„ç”Ÿæ´»ï¼Œè€ƒè™‘å¯»æ±‚ä¸“ä¸šå¸®åŠ©',
                    'ä½ æœ‰èƒ½åŠ›é¢å¯¹è¿™äº›æ„Ÿå—ï¼Œå®ƒä»¬ä¸ä¼šæ°¸è¿œæ§åˆ¶ä½ '
                ],
                general: [
                    'æˆ‘èƒ½ç†è§£ä½ çš„æ„Ÿå—ï¼Œè¿™ç§æ—¶å€™ç¡®å®å¾ˆè‰°éš¾',
                    'ç»™è‡ªå·±ä¸€ç‚¹æ—¶é—´å’Œç©ºé—´ï¼Œå…è®¸è‡ªå·±æ„Ÿå—è¿™äº›æƒ…ç»ª',
                    'è®°ä½ï¼Œå›°éš¾åªæ˜¯æš‚æ—¶çš„ï¼Œä½ ä¼šåº¦è¿‡è¿™ä¸ªé˜¶æ®µ',
                    'ä½ å·²ç»å¾ˆå‹‡æ•¢äº†ï¼Œé¢å¯¹è¿™äº›æŒ‘æˆ˜ä¸æ˜¯ä¸€ä»¶å®¹æ˜“çš„äº‹',
                    'å¦‚æœéœ€è¦å¸®åŠ©ï¼Œä¸è¦çŠ¹è±«å¯»æ±‚æ”¯æŒï¼Œä½ ä¸æ˜¯ä¸€ä¸ªäºº',
                    'è¯•ç€åšä¸€äº›è®©è‡ªå·±å¼€å¿ƒçš„äº‹æƒ…ï¼Œå“ªæ€•åªæ˜¯å¾ˆå°çš„äº‹æƒ…',
                    'ç›¸ä¿¡è‡ªå·±çš„èƒ½åŠ›ï¼Œä½ å·²ç»åº¦è¿‡äº†å¾ˆå¤šå›°éš¾æ—¶åˆ»',
                    'å¯¹è‡ªå·±æ¸©æŸ”ä¸€ç‚¹ï¼Œä½ å€¼å¾—è¢«å…³çˆ±',
                    'æ¯ä¸€ä¸ªæŒ‘æˆ˜éƒ½æ˜¯æˆé•¿çš„æœºä¼šï¼Œè™½ç„¶ç°åœ¨å¾ˆéš¾',
                    'ä¿æŒå¸Œæœ›ï¼Œæ˜å¤©ä¼šæ›´å¥½çš„'
                ]
            };
            
            // å…³é”®è¯åŒ¹é…
            if (worryLower.includes('å·¥ä½œ') || worryLower.includes('ä¸Šç­') || worryLower.includes('è€æ¿') || worryLower.includes('åŒäº‹')) {
                return getRandomResponse(responses.work);
            } else if (worryLower.includes('æ„Ÿæƒ…') || worryLower.includes('æ‹çˆ±') || worryLower.includes('æœ‹å‹') || worryLower.includes('å®¶äºº') || worryLower.includes('å…³ç³»')) {
                return getRandomResponse(responses.relationship);
            } else if (worryLower.includes('èº«ä½“') || worryLower.includes('å¥åº·') || worryLower.includes('ç”Ÿç—…') || worryLower.includes('åŒ»é™¢')) {
                return getRandomResponse(responses.health);
            } else if (worryLower.includes('å‹åŠ›') || worryLower.includes('ç´¯') || worryLower.includes('å¿™')) {
                return getRandomResponse(responses.stress);
            } else if (worryLower.includes('ç„¦è™‘') || worryLower.includes('æ‹…å¿ƒ') || worryLower.includes('å®³æ€•') || worryLower.includes('ææƒ§')) {
                return getRandomResponse(responses.anxiety);
            } else {
                return getRandomResponse(responses.general);
            }
        }
        
        // ä»æ•°ç»„ä¸­éšæœºé€‰æ‹©ä¸€ä¸ªå…ƒç´ 
        function getRandomResponse(array) {
            const randomIndex = Math.floor(Math.random() * array.length);
            return array[randomIndex];
        }
    </script>
</body>
</html>